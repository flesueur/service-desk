#==============================================================================
# Some notes on packaging Service Desk
#==============================================================================

# 1 - Archive tar.gz
#==============================================================================

php composer is required for this step to complete. please install composer.
unzip is required too.
rpm-build and rpm-sign are required too.

on redhat/fedora/rocky :

$ sudo dnf install composer rpm-sign rpm-build

From current directory, do:
$ ./makedist.sh VERSION

with VERSION the current verion of the package

For example:
$ ./makedist.sh 0.5.beta

# 2 - Debian
#==============================================================================

Form current directory, do:
$ dpkg-buildpackage -b -kLTB

If you do not have LTB GPG secret key, do:
$ dpkg-buildpackage -b -us -uc

# 3 - RPM (RHEL, CentOS, Fedora, ...)
#==============================================================================

Prepare your build environment, for example in /home/clement/build.
You should have a ~/.rpmmacros like this:

----
%_topdir /home/clement/build
%dist .el5
%distribution .el5
%_signature gpg
%_gpg_name 6D45BFC5
%_gpgbin /usr/bin/gpg
%packager Clement OUDOT <clem.oudot@gmail.com>
%vendor LTB-project
----

Copy packaging files from current directory to build directory:
$ cp -Ra rpm/* /home/clement/build

Copy Self Service Archive to SOURCES/:
$ cp ltb-project-service-desk-VERSION.tar.gz /home/clement/build/SOURCES

Go in build directory and build package:
$ cd /home/clement/build
$ rpmbuild -ba SPECS/service-desk.spec

Sign RPM:
$ rpm --addsign RPMS/noarch/service-desk*

# 4 - Docker
#==============================================================================

From current directory, do:
$ docker build -t service-desk -f ./docker/Dockerfile ../
